replication_plot <- ggplot(data = region_df, aes(y = contig)) +
geom_point(aes(shape = replication_group, x = 1), alpha = 0.7,  fill = "blue", color = "black", size = 2) +
geom_point(aes(fill = repeat_type, x = 1.1), shape = 22, color = "black", size = 2) +
scale_y_discrete(name = "", position = "right", limits = rev(get_taxa_name(p1))) +
scale_x_discrete(limits = c(0,1), name = "") +
theme_cowplot() +
theme(axis.ticks.x = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.line = element_blank(),
plot.margin = unit(c(0,0,0,0), "cm"))
p1 + replication_plot
replication_plot <- ggplot(data = region_df, aes(y = contig)) +
geom_point(aes(shape = replication_group, x = 1), alpha = 0.7,  fill = "blue", color = "black", size = 2) +
geom_point(aes(fill = repeat_type, x = 1.1), shape = 22, color = "black", size = 2) +
scale_y_discrete(name = "", position = "right", limits = rev(get_taxa_name(p1))) +
scale_x_discrete(limits = c(0,1), name = "") +
theme_cowplot() +
theme(axis.ticks.x = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.line = element_blank(),
plot.margin = unit(c(0,0,0,0), "cm"))
p1 + replication_plot
region_df$contig <- str_remove(region_df$contig, "\\_length.*")
replication_plot <- ggplot(data = region_df, aes(y = contig)) +
geom_point(aes(shape = replication_group, x = 1), alpha = 0.7,  fill = "blue", color = "black", size = 2) +
geom_point(aes(fill = repeat_type, x = 1.1), shape = 22, color = "black", size = 2) +
scale_y_discrete(name = "", position = "right", limits = rev(get_taxa_name(p1))) +
scale_x_discrete(limits = c(0,1), name = "") +
theme_cowplot() +
theme(axis.ticks.x = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.line = element_blank(),
plot.margin = unit(c(0,0,0,0), "cm"))
p1 + replication_plot
# we need family information
region_df <- as.data.table(read_sheet("https://docs.google.com/spreadsheets/d/1J9eVHjpSJsBOVN_gavMRTGaNeT7iXZSdowyOkn9GUsA/edit#gid=1238763630",
sheet = "pR1SE_relatives"))
region_df$contig <- str_remove(region_df$contig, "\\_length.*")
replication_plot <- ggplot(data = region_df, aes(y = contig)) +
geom_point(aes(shape = replication_group, x = 1), alpha = 0.7,  fill = "blue", color = "black", size = 2) +
geom_point(aes(fill = repeat_type, x = 1.1), shape = 22, color = "black", size = 2) +
scale_y_discrete(name = "", position = "right", limits = rev(get_taxa_name(p1))) +
scale_x_discrete(limits = c(0,1), name = "") +
theme_cowplot() +
theme(axis.ticks.x = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.line = element_blank(),
plot.margin = unit(c(0,0,0,0), "cm"))
p1 + replication_plot
# we need family information
region_df <- as.data.table(read_sheet("https://docs.google.com/spreadsheets/d/1J9eVHjpSJsBOVN_gavMRTGaNeT7iXZSdowyOkn9GUsA/edit#gid=1238763630",
sheet = "pR1SE_relatives"))
region_df$contig <- str_remove(region_df$contig, "\\_length.*")
replication_plot <- ggplot(data = region_df, aes(y = contig)) +
geom_point(aes(shape = replication_group, x = 1), alpha = 0.7,  fill = "blue", color = "black", size = 2) +
geom_point(aes(fill = repeat_type, x = 1.1), shape = 22, color = "black", size = 2) +
scale_y_discrete(name = "", position = "right", limits = rev(get_taxa_name(p1))) +
scale_x_discrete(limits = c(0,1), name = "") +
theme_cowplot() +
theme(axis.ticks.x = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.line = element_blank(),
plot.margin = unit(c(0,0,0,0), "cm"))
p1 + replication_plot
install.packages("ggflags")
devtools::install_githubs("rensa/ggflags")
devtools::install_github("rensa/ggflags")
library(ggflags)
replication_plot <- ggplot(data = region_df, aes(y = contig)) +
geom_point(aes(shape = replication_group, x = 1), alpha = 0.7,  fill = "blue", color = "black", size = 2) +
geom_point(aes(fill = repeat_type, x = 1.1), shape = 22, color = "black", size = 2) +
geom_label(mapping = country) +
scale_y_discrete(name = "", position = "right", limits = rev(get_taxa_name(p1))) +
scale_x_discrete(limits = c(0,1), name = "") +
theme_cowplot() +
theme(axis.ticks.x = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.line = element_blank(),
plot.margin = unit(c(0,0,0,0), "cm"))
replication_plot <- ggplot(data = region_df, aes(y = contig)) +
geom_point(aes(shape = replication_group, x = 1), alpha = 0.7,  fill = "blue", color = "black", size = 2) +
geom_point(aes(fill = repeat_type, x = 1.1), shape = 22, color = "black", size = 2) +
geom_label(aes(country)) +
scale_y_discrete(name = "", position = "right", limits = rev(get_taxa_name(p1))) +
scale_x_discrete(limits = c(0,1), name = "") +
theme_cowplot() +
theme(axis.ticks.x = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.line = element_blank(),
plot.margin = unit(c(0,0,0,0), "cm"))
p1 + replication_plot
replication_plot <- ggplot(data = region_df, aes(y = contig)) +
geom_point(aes(shape = replication_group, x = 0), alpha = 0.7,  fill = "blue", color = "black", size = 2) +
geom_point(aes(fill = repeat_type, x = 0.1), shape = 22, color = "black", size = 2) +
geom_label(aes(label = country), position = x = 0.2) +
p1 + replication_plot
replication_plot <- ggplot(data = region_df, aes(y = contig)) +
geom_point(aes(shape = replication_group, x = 0), alpha = 0.7,  fill = "blue", color = "black", size = 2) +
geom_point(aes(fill = repeat_type, x = 0.1), shape = 22, color = "black", size = 2) +
geom_label(aes(label = country), x = 0.2) +
scale_y_discrete(name = "", position = "right", limits = rev(get_taxa_name(p1))) +
scale_x_discrete(limits = c(0,0.3), name = "") +
theme_cowplot() +
theme(axis.ticks.x = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.line = element_blank(),
plot.margin = unit(c(0,0,0,0), "cm"))
p1 + replication_plot
replication_plot <- ggplot(data = region_df, aes(y = contig)) +
geom_point(aes(shape = replication_group, x = 0), alpha = 0.7,  fill = "blue", color = "black", size = 2) +
geom_point(aes(fill = repeat_type, x = 0.1), shape = 22, color = "black", size = 2) +
geom_label(aes(label = country), x = 0.2, check_overlap = TRUE) +
scale_y_discrete(name = "", position = "right", limits = rev(get_taxa_name(p1))) +
scale_x_discrete(limits = c(0,0.3), name = "") +
theme_cowplot() +
theme(axis.ticks.x = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.line = element_blank(),
plot.margin = unit(c(0,0,0,0), "cm"))
p1 + replication_plot
replication_plot <- ggplot(data = region_df, aes(y = contig)) +
geom_point(aes(shape = replication_group, x = 0), alpha = 0.7,  fill = "blue", color = "black", size = 2) +
geom_point(aes(fill = repeat_type, x = 0.1), shape = 22, color = "black", size = 2) +
geom_text(aes(label = country), x = 0.2, check_overlap = TRUE) +
scale_y_discrete(name = "", position = "right", limits = rev(get_taxa_name(p1))) +
scale_x_discrete(limits = c(0,0.3), name = "") +
theme_cowplot() +
theme(axis.ticks.x = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.line = element_blank(),
plot.margin = unit(c(0,0,0,0), "cm"))
p1 + replication_plot
replication_plot <- ggplot(data = region_df, aes(y = contig)) +
geom_point(aes(shape = replication_group, x = 0), alpha = 0.7,  fill = "blue", color = "black", size = 2) +
geom_point(aes(fill = repeat_type, x = 0.1), shape = 22, color = "black", size = 2) +
geom_text(aes(label = country), x = 0.2, check_overlap = TRUE, align = "left") +
scale_y_discrete(name = "", position = "right", limits = rev(get_taxa_name(p1))) +
scale_x_discrete(limits = c(0,0.3), name = "") +
theme_cowplot() +
theme(axis.ticks.x = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.line = element_blank(),
plot.margin = unit(c(0,0,0,0), "cm"))
p1 + replication_plot
replication_plot <- ggplot(data = region_df, aes(y = contig)) +
geom_point(aes(shape = replication_group, x = 0), alpha = 0.7,  fill = "blue", color = "black", size = 2) +
geom_point(aes(fill = repeat_type, x = 0.1), shape = 22, color = "black", size = 2) +
geom_text(aes(label = country), x = 0.2, check_overlap = TRUE, hjust = 0) +
scale_y_discrete(name = "", position = "right", limits = rev(get_taxa_name(p1))) +
scale_x_discrete(limits = c(0,0.3), name = "") +
theme_cowplot() +
theme(axis.ticks.x = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.line = element_blank(),
plot.margin = unit(c(0,0,0,0), "cm"))
p1 + replication_plot
# we need family information
region_df <- as.data.table(read_sheet("https://docs.google.com/spreadsheets/d/1J9eVHjpSJsBOVN_gavMRTGaNeT7iXZSdowyOkn9GUsA/edit#gid=1238763630",
sheet = "pR1SE_relatives"))
region_df$contig <- str_remove(region_df$contig, "\\_length.*")
replication_plot <- ggplot(data = region_df, aes(y = contig)) +
geom_point(aes(shape = replication_group, x = 0), alpha = 0.7,  fill = "blue", color = "black", size = 2) +
geom_point(aes(fill = repeat_type, x = 0.1), shape = 22, color = "black", size = 2) +
geom_text(aes(label = country), x = 0.2, check_overlap = TRUE, hjust = 0) +
scale_y_discrete(name = "", position = "right", limits = rev(get_taxa_name(p1))) +
scale_x_discrete(limits = c(0,0.3), name = "") +
theme_cowplot() +
theme(axis.ticks.x = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.line = element_blank(),
plot.margin = unit(c(0,0,0,0), "cm"))
p1 + replication_plot
replication_plot <- ggplot(data = region_df, aes(y = contig)) +
geom_point(aes(shape = replication_group, x = 0), alpha = 0.7,  fill = "blue", color = "black", size = 2) +
geom_point(aes(fill = repeat_type, x = 0.1), shape = 22, color = "black", size = 2) +
geom_text(aes(label = country), x = 0.2, hjust = 0) +
scale_y_discrete(name = "", position = "right", limits = rev(get_taxa_name(p1))) +
scale_x_discrete(limits = c(0,0.3), name = "") +
theme_cowplot() +
theme(axis.ticks.x = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.line = element_blank(),
plot.margin = unit(c(0,0,0,0), "cm"))
p1 + replication_plot
replication_plot <- ggplot(data = region_df, aes(y = contig)) +
geom_point(aes(shape = replication_group, x = 0), alpha = 0.7,  fill = "blue", color = "black", size = 2) +
geom_point(aes(fill = repeat_type, x = 0.1), shape = 22, color = "black", size = 2) +
geom_text(aes(label = country), x = 0.2, hjust = 0) +
scale_y_discrete(name = "", position = "right", limits = rev(get_taxa_name(p1))) +
scale_x_discrete(limits = c(0,0.3), name = "") +
theme_cowplot() +
theme(axis.ticks.x = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.line = element_blank(),
plot.margin = unit(c(0,0,0,0), "cm"),
legend.position = "bottom")
p1 + replication_plot
replication_plot <- ggplot(data = region_df, aes(y = contig)) +
geom_point(aes(shape = replication_group, x = 0), alpha = 0.7,  fill = "blue", color = "black", size = 2) +
geom_point(aes(fill = repeat_type, x = 0.1), shape = 22, color = "black", size = 2) +
geom_text(aes(label = country), x = 0.2, hjust = 0) +
scale_y_discrete(name = "", position = "right", limits = rev(get_taxa_name(p1))) +
scale_x_discrete(limits = c(0,0.3), name = "") +
theme_cowplot() +
theme(axis.ticks.x = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.line = element_blank(),
plot.margin = unit(c(0,0,0,0), "cm"))
p1 + replication_plot
replication_plot <- ggplot(data = region_df, aes(y = contig)) +
geom_point(aes(shape = replication_group, x = 0), alpha = 0.7,  fill = "blue", color = "black", size = 2) +
geom_point(aes(fill = repeat_type, x = 0.1), shape = 22, color = "black", size = 2) +
geom_text(aes(label = country), x = 0.2, hjust = 0) +
scale_y_discrete(name = "", position = "right", limits = rev(get_taxa_name(p1))) +
# scale_x_discrete(limits = c(0,0.3), name = "") +
theme_cowplot() +
theme(axis.ticks.x = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.line = element_blank(),
plot.margin = unit(c(0,0,0,0), "cm"))
p1 + replication_plot
replication_plot <- ggplot(data = region_df, aes(y = contig)) +
geom_point(aes(shape = replication_group, x = 0), alpha = 0.7,  fill = "blue", color = "black", size = 2) +
geom_point(aes(fill = repeat_type, x = 0.1), shape = 22, color = "black", size = 2) +
geom_text(aes(label = country), x = 0.2, hjust = 0) +
scale_y_discrete(name = "", position = "right", limits = rev(get_taxa_name(p1))) +
scale_x_discrete(limits = c(0,0.2), name = "") +
theme_cowplot() +
theme(axis.ticks.x = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.line = element_blank(),
plot.margin = unit(c(0,0,0,0), "cm"))
p1 + replication_plot
# we need family information
region_df <- as.data.table(read_sheet("https://docs.google.com/spreadsheets/d/1J9eVHjpSJsBOVN_gavMRTGaNeT7iXZSdowyOkn9GUsA/edit#gid=1238763630",
sheet = "pR1SE_relatives"))
region_df$contig <- str_remove(region_df$contig, "\\_length.*")
replication_plot <- ggplot(data = region_df, aes(y = contig)) +
geom_point(aes(shape = replication_group, x = 0), alpha = 0.7,  fill = "blue", color = "black", size = 2) +
geom_point(aes(fill = repeat_type, x = 0.1), shape = 22, color = "black", size = 2) +
geom_text(aes(label = country), x = 0.2, hjust = 0) +
scale_y_discrete(name = "", position = "right", limits = rev(get_taxa_name(p1))) +
scale_x_discrete(limits = c(0,0.2), name = "") +
theme_cowplot() +
theme(axis.ticks.x = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.line = element_blank(),
plot.margin = unit(c(0,0,0,0), "cm"))
p1 + replication_plot
region_df$contig <- str_remove(region_df$contig, "\\_length.*")
region_df$contig <- paste0(region_df$contig, " (", region_df$country, ")")
region_df$contig <- str_remove(region_df$contig, "()")
replication_plot <- ggplot(data = region_df, aes(y = contig)) +
geom_point(aes(shape = replication_group, x = 0), alpha = 0.7,  fill = "blue", color = "black", size = 2) +
geom_point(aes(fill = repeat_type, x = 0.1), shape = 22, color = "black", size = 2) +
geom_text(aes(label = country), x = 0.2, hjust = 0) +
scale_y_discrete(name = "", position = "right", limits = rev(get_taxa_name(p1))) +
scale_x_discrete(limits = c(0,0.2), name = "") +
theme_cowplot() +
theme(axis.ticks.x = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.line = element_blank(),
plot.margin = unit(c(0,0,0,0), "cm"))
p1 + replication_plot
p1 <- ggtree(tree, branch.length = 10) +
theme(plot.margin = unit(c(1, 0.1, 1, 1), "cm")) +
# geom_treescale(y = -3) +
geom_tiplab(align = TRUE, offset = 0.1, as_ylab = TRUE, color = "black") +
geom_tippoint(color = "black", shape = 23, size = 4, fill = feature_table$color)
# add presence absence plot -----------------------------------------------
SEARCH_TERMS <- c("helicase", "cdc6", "HNH", "endonuclease", "recombinase", "integrase", "transposase", "pilin", "Vaccinia Virus protein VP39")
contig_df <- data.table("contig" = unique(interpro_df$contig))
for(word in SEARCH_TERMS){
tmp_df <- interpro_df %>%
group_by(contig) %>%
summarize(word = ifelse(
any(str_detect(annotation, regex(paste0(".*", word, ".*"), ignore_case = TRUE))
), TRUE, FALSE))
names(tmp_df) <- c("contig", word)
contig_df <- left_join(contig_df, tmp_df, by = "contig")
}
# combine information
to_plot <- gather(contig_df, key = "gene", value = "val", -contig)
to_plot$contig <- str_remove(to_plot$contig, "\\_length.*")
# plot
p2 <- ggplot(to_plot, aes(x = gene,y = contig, fill = , alpha = val)) +
geom_tile(colour = "black") +
scale_alpha_identity(guide = "none") +
coord_equal(expand = 0) +
theme_bw() +
theme(panel.grid.major = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
legend.position = "None") +
ggtitle("Others") +
ylab("") +
xlab("") +
scale_y_discrete(name = "", position = "right", limits = rev(get_taxa_name(p1)))
# author: dlueckin
# date: Thu Aug 10 10:20:42 2023
# libraries ---------------------------------------------------------------
library(data.table)
library(stringr)
library(seqinr)
library(tidyr)
library(ggplot2)
library(dplyr)
library(vegan)
# library(hclust)
library(ggplotify)
library(ggtree)
library(ape)
library(googlesheets4)
library(aplot)
# working directory -------------------------------------------------------
this_dir <- dirname(rstudioapi::getSourceEditorContext()$path)
setwd(this_dir)
print(paste0("Setting wd to: \n ", this_dir))
# import data -------------------------------------------------------------
cluster_df <- fread("clean_cluster_df.csv") %>%
filter(cluster_annotation != "" | occurances >= 4)
cluster_df$final_cluster <- cluster_df$cluster
cluster_df$final_cluster[cluster_df$cluster_annotation != ""] <- cluster_df$cluster_annotation[cluster_df$cluster_annotation != ""]
# create new wide df ------------------------------------------------------
wide <- data.frame(cluster = unique(cluster_df$final_cluster))
wide[unique(cluster_df$contig)] <- 0
# fill it
for(row in 1:nrow(wide)){
for(column in 2:length(wide)){
value <- cluster_df %>%
filter(final_cluster == wide$cluster[row]) %>%
filter(contig == names(wide)[column]) %>%
nrow()
if(value >= 1)
wide[row,column] <- 1
}
}
rm(row, column)
# prepare for tree --------------------------------------------------------
wide_transposed <- t(wide %>% select(-cluster))
dist <- vegdist(wide_transposed)
hclust_avg <- hclust(dist, method = "average")
p_classic <- plot(hclust_avg, xlab = "", ylab = "distance",
hang = -1, direction = "left")
# not great.  I have to export it. Or figure out
# ggtree plot -------------------------------------------------------------
# first convert the tree
tree <- as.phylo(hclust_avg)
# we need family information
region_df <- as.data.table(read_sheet("https://docs.google.com/spreadsheets/d/1J9eVHjpSJsBOVN_gavMRTGaNeT7iXZSdowyOkn9GUsA/edit#gid=1238763630",
sheet = "pR1SE_relatives"))
feature_table <- data.table(label = tree$tip.label, host = "")
feature_table$host <- region_df$family[match(feature_table$label, region_df$contig)]
# Define a color palette mapping each unique host value to a color
color_palette <- c("#ffbe0b", "#fb5607", "#ff006e", "#8338ec", "#3a86ff", "grey", "darkgreen")
# Add the "color" column to the feature_table based on the host value
feature_table[, color := color_palette[match(host, unique(host))]]
tree_plot <- ggtree(tree, branch.length = 10) +
theme(plot.margin = unit(c(1, 0.1, 1, 1), "cm")) +
# geom_treescale(y = -3) +
geom_tiplab(align = TRUE, offset = 0.1, as_ylab = TRUE, color = "black") +
geom_tippoint(color = "black", shape = 23, size = 4, fill = feature_table$color)
region_df$contig <- str_remove(region_df$contig, "\\_length.*")
region_df$contig <- paste0(region_df$contig, " (", region_df$country, ")")
region_df$contig <- str_remove(region_df$contig, "()")
replication_plot <- ggplot(data = region_df, aes(y = contig)) +
geom_point(aes(shape = replication_group, x = 0), alpha = 0.7,  fill = "blue", color = "black", size = 2) +
geom_point(aes(fill = repeat_type, x = 0.1), shape = 22, color = "black", size = 2) +
geom_text(aes(label = country), x = 0.2, hjust = 0) +
scale_y_discrete(name = "", position = "right", limits = rev(get_taxa_name(p1))) +
scale_x_discrete(limits = c(0,0.2), name = "") +
theme_cowplot() +
theme(axis.ticks.x = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.line = element_blank(),
plot.margin = unit(c(0,0,0,0), "cm"))
# old
# add presence absence plot -----------------------------------------------
SEARCH_TERMS <- c("helicase", "cdc6", "HNH", "endonuclease", "recombinase", "integrase", "transposase", "pilin", "Vaccinia Virus protein VP39")
library(patchwork)
replication_plot <- ggplot(data = region_df, aes(y = contig)) +
geom_point(aes(shape = replication_group, x = 0), alpha = 0.7,  fill = "blue", color = "black", size = 2) +
geom_point(aes(fill = repeat_type, x = 0.1), shape = 22, color = "black", size = 2) +
geom_text(aes(label = country), x = 0.2, hjust = 0) +
scale_y_discrete(name = "", position = "right", limits = rev(get_taxa_name(p1))) +
scale_x_discrete(limits = c(0,0.2), name = "") +
theme_cowplot() +
theme(axis.ticks.x = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.line = element_blank(),
plot.margin = unit(c(0,0,0,0), "cm"))
replication_plot <- ggplot(data = region_df, aes(y = contig)) +
geom_point(aes(shape = replication_group, x = 0), alpha = 0.7,  fill = "blue", color = "black", size = 2) +
geom_point(aes(fill = repeat_type, x = 0.1), shape = 22, color = "black", size = 2) +
geom_text(aes(label = country), x = 0.2, hjust = 0) +
scale_y_discrete(name = "", position = "right", limits = rev(get_taxa_name(p1))) +
scale_x_discrete(limits = c(0,0.2), name = "") +
theme_cowplot() +
theme(axis.ticks.x = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.line = element_blank(),
plot.margin = unit(c(0,0,0,0), "cm"))
tree_plot + replication_plot
ggplot(data = region_df, aes(y = contig)) +
geom_point(aes(shape = replication_group, x = 0), alpha = 0.7,  fill = "blue", color = "black", size = 2) +
geom_point(aes(fill = repeat_type, x = 0.1), shape = 22, color = "black", size = 2) +
geom_text(aes(label = country), x = 0.2, hjust = 0) +
scale_y_discrete(name = "", position = "right", limits = rev(get_taxa_name(p1))) +
scale_x_discrete(limits = c(0,0.2), name = "") +
theme_cowplot() +
theme(axis.ticks.x = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.line = element_blank(),
plot.margin = unit(c(0,0,0,0), "cm"))
tree_plot <- ggtree(tree, branch.length = 10) +
theme(plot.margin = unit(c(1, 0.1, 1, 1), "cm")) +
# geom_treescale(y = -3) +
geom_tiplab(align = TRUE, offset = 0.1, as_ylab = TRUE, color = "black") +
geom_tippoint(color = "black", shape = 23, size = 4, fill = feature_table$color)
tree_plot
ggplot(data = region_df, aes(y = contig)) +
geom_point(aes(shape = replication_group, x = 0), alpha = 0.7,  fill = "blue", color = "black", size = 2) +
geom_point(aes(fill = repeat_type, x = 0.1), shape = 22, color = "black", size = 2) +
geom_text(aes(label = country), x = 0.2, hjust = 0) +
scale_y_discrete(name = "", position = "right", limits = rev(get_taxa_name(tree_plot))) +
scale_x_discrete(limits = c(0,0.2), name = "") +
theme_cowplot() +
theme(axis.ticks.x = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.line = element_blank(),
plot.margin = unit(c(0,0,0,0), "cm"))
ggplot(data = region_df, aes(y = contig)) +
geom_point(aes(shape = replication_group, x = 0), alpha = 0.7,  fill = "blue", color = "black", size = 2) +
scale_y_discrete(name = "", position = "right", limits = rev(get_taxa_name(tree_plot))) +
scale_x_discrete(limits = c(0,0.2), name = "") +
theme_cowplot() +
theme(axis.ticks.x = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.line = element_blank(),
plot.margin = unit(c(0,0,0,0), "cm"))
# replication plot
region_df$contig <- str_remove(region_df$contig, "\\_length.*")
ggplot(data = region_df, aes(y = contig)) +
geom_point(aes(shape = replication_group, x = 0), alpha = 0.7,  fill = "blue", color = "black", size = 2) +
scale_y_discrete(name = "", position = "right", limits = rev(get_taxa_name(tree_plot))) +
scale_x_discrete(limits = c(0,0.2), name = "") +
theme_cowplot() +
theme(axis.ticks.x = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.line = element_blank(),
plot.margin = unit(c(0,0,0,0), "cm"))
# we need family information
region_df <- as.data.table(read_sheet("https://docs.google.com/spreadsheets/d/1J9eVHjpSJsBOVN_gavMRTGaNeT7iXZSdowyOkn9GUsA/edit#gid=1238763630",
sheet = "pR1SE_relatives"))
# we need family information
region_df <- as.data.table(read_sheet("https://docs.google.com/spreadsheets/d/1J9eVHjpSJsBOVN_gavMRTGaNeT7iXZSdowyOkn9GUsA/edit#gid=1238763630",
sheet = "pR1SE_relatives"))
